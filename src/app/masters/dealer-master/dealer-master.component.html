<section>
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">
        <!-- searchbar-row -->
        <div class="sidebarMain">
            <div class="row">
                <div class="col-md-12">
                    <ul class="model-menu">
                        <li><a routerLink="/home">Master</a></li>/
                        <li><a routerLink="/m-dealer">Dealer Master</a></li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <div class="searchBar d-flex justify-content-center align-items-center">
                        <i class="fas fa-search"></i><input class="form-control" type="search" [(ngModel)]="searchData" placeholder="Search" aria-label="Search">
                    </div>
                </div>
                <div class="col-md-6 align-self-end text-end">
                    <div class="modelBtnMain">
                        <button type="button" data-bs-toggle="modal" data-bs-target="#addDealer" class="btn btn-primary text-uppercase me-2">+ Add Dealer</button>
                        <button type="button" class="btn btn-primary" *ngIf="isExcelDownload" (click)="download()" title="Download selected records"><i class="fa fa-download"></i></button>
                    </div>
                    <label for="limit">
                        <select id="limit" name="limit" class="form-select" (click)="dataLimit()">
                            <option *ngFor="let limit of limits" value="{{limit.value}}">{{limit.key}}</option>
                        </select>
                    </label>
                </div>
            </div>
        </div>
        <!-- searchbar-row -->
        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle" id="export">
            <thead class="text-white sticky-top theadbg">
              <tr>
                <th>#</th>
                <th>Dealer Code</th>
                <th>SAP Code</th>
                <th>Dealer Name</th>
                <th>Location</th>
                <th>State</th>
                <th>Address</th>
                <th>PAN No.</th>
                <th>Dealership Type</th>
                <th>Dealer Head</th>
                <th>Email ID</th>
                <th>Head Mobile</th>
                <th>AOC</th>
                <th>Dealer GST</th>
                <th>LOI</th>
                <th>Expiry Date</th>
                <th>Status</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let dealer of dealerData | filter: searchData | paginate: { itemsPerPage: limit, currentPage: pageData }; let i = index">
                <td data-title="Sr. No.">{{limit*(pageData-1)+i+1}}</td>
                <td data-title="Dealer Code"><a class="table-href" data-bs-toggle="modal" data-bs-target="#dealerinfo" (click)="viewFullInfo(dealer)">{{dealer?.dealerCode}}</a></td>
                <td data-title="SAP Code">{{dealer?.dealerCode}}</td>
                <td data-title="Dealer Name">{{dealer?.dealerName}}</td>
                <td data-title="Location">{{dealer?.address?.cityName | uppercase}}</td>
                <td data-title="State">{{dealer?.address?.stateName | uppercase}}</td>
                <td data-title="Address">{{dealer?.address?.dealerAddress | uppercase}}</td>
                <td data-title="PAN No.">{{dealer?.dealerPAN}}</td>
                <td data-title="Dealership Type">{{dealer?.dealershipType}}</td>
                <td data-title="Dealer Head">{{dealer?.dealerHead.name}}</td>
                <td data-title="Email ID">{{dealer?.dealerHead.email}}</td>
                <td data-title="Head Mobile">{{dealer?.dealerHead.mobile}}</td>
                <td data-title="AOC">{{dealer?.areaOfConcertration}}</td>
                <td data-title="Dealer GST">{{dealer?.dealerGST}}</td>
                <td data-title="LOI">{{dealer?.LOIDate | date:"dd-MM-yyyy"}}</td>
                <td data-title="Expiry Date">{{dealer?.ExpiryLOIDate | date:"dd-MM-yyyy"}}</td>
                <td data-title="Status">{{dealer?.dealerStatus}}</td>
                <td data-title="Options">
                    <a class="editIcon mb-1" [routerLink]="['/master/edit-dealer', dealer?._id]"><i class="fa fa-edit"></i></a>
                    <a class="deleteIcon" data-bs-toggle="modal" data-bs-target="#deleteModal" (click)="sureDelete(dealer?.dealerCode)"><i class="fa fa-trash-alt"></i></a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="input-group-icon input-group-icon-right mt-2">
          <pagination-controls (pageChange)="pageData = $event"></pagination-controls>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- Delete Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-danger text-center" role="alert">Are you sure you want to deactivate this Dealer?</div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" (click)="dealerStatus()">Confirm Deactivation</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- viewFullInfo modal -->
<div class="modal fade" id="dealerinfo" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" *ngFor="let dealer of dealerInfo">
        <div class="modal-header modalHeaderCenter" style="background: #454397">
            <h4 class="modal-title text-white text-center">{{dealer?.dealerCode}} - {{dealer?.dealerName}}</h4>
          <!-- <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> -->
          <a class="btn-close2" data-bs-dismiss="modal" aria-label="Close"><i class="fa fa-times"></i></a>
        </div>
        <div class="modal-body">
          <div class="container">
            <div class="row">
                <div class="col-6 col-md-6 p-2">
                    <div class="row mt-1">
                        <div class="col-5"><b>Dealer Code</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.dealerCode}}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-5"><b>SAP Code</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.dealerCode}}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-5"><b>Dealer Name</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.dealerName}}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-5"><b>Location</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.address?.cityName }}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-5"><b>State</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.address?.stateName}}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-5"><b>Address</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.address?.dealerAddress}}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-5"><b>PAN No.</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.dealerPAN}}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-5"><b>Dealership Type</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.dealershipType}}</div>
                    </div>
                </div>
                <div class="col-6 col-md-6 p-2">
                    <div class="row mt-1">
                        <div class="col-5"><b>Dealer Head</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.dealerHead.name}}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-5"><b>Email ID</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.dealerHead.email}}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-5"><b>Head Mobile</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.dealerHead.mobile}}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-5"><b>AOC</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.areaOfConcertration}}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-5"><b>Dealer GST</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.dealerGST}}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-5"><b>LOI</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.LOIDate | date:"dd-MM-yyyy"}}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-5"><b>Expiry Date</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.ExpiryLOIDate | date:"dd-MM-yyyy"}}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-5"><b>Status</b></div>
                        <div class="col-1"><b>:</b></div>
                        <div class="col-6">{{dealer?.dealerStatus}}</div>
                    </div>
                </div>
              </div>
          </div>
        </div>
        <div class="modal-footer border-btm">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
