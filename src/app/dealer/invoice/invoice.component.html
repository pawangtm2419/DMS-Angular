<section>
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">
        <!-- searchbar-row -->
        <div class="row mb-2">
          <div class="col-md-12">
            <ul class="model-menu">
              <li onclick="goBack()"><button class="badge bg-dark"><i class="fas fa-arrow-left"></i> Back</button></li>
              <li><a routerLink="/">Dealer</a></li>/
              <li><a routerLink="/invoices"> Invoices</a></li>
            </ul>
          </div>
          <div class="col-md-6 col-12">
            <div class="searchBar mt-2 d-flex justify-content-center align-items-center">
              <i class="fas fa-search"></i><input class="form-control" type="search" [(ngModel)]="searchData" placeholder="Search" aria-label="Search">
            </div>
          </div>
          <div class="col-md-6 col-12 align-self-end text-end filterMain">
            <button class="btn btn-primary me-2" type="button" data-bs-toggle="collapse" title="Filter" data-bs-target="#filter" aria-expanded="false" aria-controls="collapseExample"> <i class="fas fa-filter"></i> </button>
            <button type="button" class="btn btn-primary me-2" *ngIf="isExcelDownload" (click)="download()" title="Download selected records"><i class="fa fa-download"></i></button>
            <label for="limit">
              <select id="limit" name="limit" class="form-select" (click)="dataLimit()">
                <option *ngFor="let limit of limits" value="{{limit.value}}">{{limit.key}}</option>
              </select>
            </label>
          </div>
        </div>
        <div class="collapse mb-2" id="filter">
          <div class="card card-body">
            <div class="container">
              <div class="row">
                <div class="col-md-8 mx-auto">
                  <div class="row" style="--bs-gutter-x: 1.5rem;">
                    <div class="col-md-5 col-sm-6 col-12 mbSm">
                      <div class="row align-items-center">
                        <div class="col-md-2 col-2">
                          <label for="fromDate" class="col-form-label">From: </label>
                        </div>
                        <div class="col-md-10 col-10">
                          <input type="date" id="fromDate" [ngModel]="fromDate | date:'yyyy-MM-dd'" max="{{currentDate}}" class="form-control">
                        </div>
                      </div>
                    </div>
                    <div class="col-md-5 col-sm-6 col-12 mbSm">
                      <div class="row align-items-center">
                        <div class="col-md-2 col-2">
                          <label for="toDate" class="col-form-label">To: </label>
                        </div>
                        <div class="col-md-10 col-10">
                          <input type="date" id="toDate" [ngModel]="toDate | date:'yyyy-MM-dd'" max="{{currentDate}}" class="form-control">
                        </div>
                      </div>
                    </div>
                    <div class="col-md-2 col-sm-12 col-12 searDateBtn">
                      <button class="btn btn-primary" (click)="getinvoiceData()">Search</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- searchbar-row -->
        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle" id="export">
            <thead class="text-white sticky-top theadbg">
              <tr>
                <th>#</th>
                <th>Invoice NO.</th>
                <th>Invoice Date</th>
                <th>From</th>
                <th>To</th>
                <th>Code</th>
                <th>Name</th>
                <th>Location</th>
                <th>State</th>
                <th>Model </th>
                <th>variant </th>
                <th>ChassisNo</th>
                <th>ProductCode</th>
                <th>Quantity</th>
                <th>Status</th>
                <th>Variant Price</th>
                <th>Price w/o Tax</th>
                <th>Discount</th>
                <th>Total Price</th>
                <th>Tax Amount</th>
                <th>Invoice value</th>
              </tr>
            </thead>
            <tbody>
              <tr [ngStyle]="{'color': (invoice?.data[0]?.isReturned) ? 'Red' : '#000'}" *ngFor="let invoice of invoiceData | filter: searchData | paginate: { itemsPerPage: limit, currentPage: pageData }; let i=index">
                <td data-title="Sr. No.">{{limit*(pageData-1)+i+1}}</td>
                <td data-title="Invoice No.">{{invoice?.data[0]?.invoiceNumber }}</td>
                <td data-title="Received Date">{{invoice?.data[0]?.invoiceDate | date:"dd-MM-yyyy" }}</td>
                <td data-title="From Depot">{{invoice?.data[0]?.previousState.name}}</td>
                <td data-title="To Depot">{{invoice?.data[0]?.dealer?.name}} </td>
                <td data-title="Received Date">{{invoice?.data[0]?.dealer?.code}}</td>
                <td data-title="Name">{{invoice?.data[0]?.name}}</td>
                <td data-title="Received Date">{{invoice?.data[0]?.city}}</td>
                <td data-title="Sr. No.">{{invoice?.data[0]?.state}}</td>
                <td data-title="Sr. No.">{{invoice?.data[0]?.model}}</td>
                <td data-title="Sr. No.">{{invoice?.data[0]?.variantCode}}</td>
                <td data-title="Sr. No.">{{invoice?.data[0]?.chassisNo}}</td>
                <td data-title="Sr. No.">{{invoice?.data[0]?.productCode}}</td>
                <td data-title="To Depot">{{invoice?.data[0]?.isReturned ? -1 : 1}} </td>
                <td data-title="To Depot">{{invoice?.data[0]?.status}}</td>
                <td data-title="To Depot">{{invoice?.data[0]?.NDP}}</td>
                <td data-title="To Depot">{{ invoice?.data[0]?.NDP-invoice?.data[0]?.dealer?.discountAmount}}</td>
                <td data-title="To Depot">{{invoice?.data[0]?.dealer?.discountAmount}}</td>
                <td data-title="To Depot">{{invoice?.data[0]?.NDP-invoice?.data[0]?.dealer?.discountAmount}}</td>
                <td data-title="To Depot">{{invoice?.data[0]?.invoiceAmount -(invoice?.data[0]?.NDP-invoice?.data[0]?.dealer?.discountAmount) | number}}</td>
                <td data-title="Invoice No.">{{invoice?.status=="Sale Return"?'-':''}}{{invoice?.data[0]?.invoiceAmount}}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="input-group-icon input-group-icon-right mt-2">
          <pagination-controls (pageChange)="pageData = $event"></pagination-controls>
        </div>
      </div>
    </div>
  </div>
</section>
